<div class="register-container">
  <div class="register-card">
    <h1 class="register-title">Inscription INSEA</h1>
    
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
      <mat-form-field appearance="outline">
        <mat-label>Prénom</mat-label>
        <input matInput formControlName="prenom" placeholder="Prénom" required>
        <mat-error *ngIf="registerForm.get('prenom')?.hasError('required')">
          Le prénom est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('prenom')?.hasError('pattern')">
          Le prénom doit commencer par une majuscule
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Nom</mat-label>
        <input matInput formControlName="nom" placeholder="Nom" required>
        <mat-error *ngIf="registerForm.get('nom')?.hasError('required')">
          Le nom est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('nom')?.hasError('pattern')">
          Le nom doit être en majuscules
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" type="email" placeholder="exemple@insea.ac.ma" required>
        <mat-error *ngIf="registerForm.get('email')?.hasError('required')">
          L'email est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('email')?.hasError('pattern')">
          L'email doit être une adresse INSEA (&#64;insea.ac.ma)
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Numéro de Carte Nationale</mat-label>
        <input matInput formControlName="numeroCarteNationale" placeholder="Ex: SB15565" required>
        <mat-error *ngIf="registerForm.get('numeroCarteNationale')?.hasError('required')">
          Le numéro de carte nationale est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('numeroCarteNationale')?.hasError('pattern')">
          Format invalide (ex: SB15565)
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Téléphone</mat-label>
        <input matInput formControlName="telephone" placeholder="Ex: 0620868815" required>
        <mat-error *ngIf="registerForm.get('telephone')?.hasError('required')">
          Le numéro de téléphone est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('telephone')?.hasError('pattern')">
          Format invalide (ex: 0620868815)
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Date de Naissance</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="dateNaissance" required>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-error *ngIf="registerForm.get('dateNaissance')?.hasError('required')">
          La date de naissance est requise
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Genre</mat-label>
        <mat-select formControlName="genre" required>
          <mat-option value="M">Masculin</mat-option>
          <mat-option value="F">Féminin</mat-option>
        </mat-select>
        <mat-error *ngIf="registerForm.get('genre')?.hasError('required')">
          Le genre est requis
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Rôle</mat-label>
        <mat-select formControlName="role" required>
          <mat-option [value]="'ETUDIANT'">Étudiant</mat-option>
          <mat-option [value]="'PROFESSEUR'">Professeur</mat-option>
        </mat-select>
      </mat-form-field>

      <ng-container *ngIf="isStudent">
        <mat-form-field appearance="outline">
          <mat-label>Filière</mat-label>
          <mat-select formControlName="filiere" required>
            <mat-option value="DSE">Data Science & Économétrie (DSE)</mat-option>
            <mat-option value="AF">Actuariat-Finance (AF)</mat-option>
            <mat-option value="SDRO">Science des Données & Recherche Opérationnelle (SDRO)</mat-option>
            <mat-option value="ROAD">Recherche Opérationnelle & Aide à la Décision (ROAD)</mat-option>
            <mat-option value="DS">Data Science (DS)</mat-option>
            <mat-option value="ESBD">Économie & Statistique pour la Big Data (ESBD)</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Année</mat-label>
          <mat-select formControlName="annee" required>
            <mat-option value="1ere">1ère année</mat-option>
            <mat-option value="2eme">2ème année</mat-option>
            <mat-option value="3eme">3ème année</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>

      <mat-form-field appearance="outline">
        <mat-label>Mot de passe</mat-label>
        <input matInput [type]="hidePassword ? 'password' : 'text'" 
               formControlName="motDePasse" required>
        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
          <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
        </button>
        <mat-error *ngIf="registerForm.get('motDePasse')?.hasError('required')">
          Le mot de passe est requis
        </mat-error>
        <mat-error *ngIf="registerForm.get('motDePasse')?.hasError('pattern')">
          Le mot de passe doit contenir au moins 8 caractères, une majuscule, une minuscule, un chiffre et un caractère spécial
        </mat-error>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit" 
              [disabled]="registerForm.invalid || loading" class="submit-button">
        {{loading ? 'Inscription en cours...' : 'S\'inscrire'}}
      </button>

      <div class="login-link">
        <a routerLink="/auth/login">Déjà inscrit ? Se connecter</a>
      </div>
    </form>
  </div>
</div> 